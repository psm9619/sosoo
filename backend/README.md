# Sosoo Backend

AI ê¸°ë°˜ ìŠ¤í”¼ì¹˜ ì½”ì¹­ ì„œë¹„ìŠ¤ì˜ ë°±ì—”ë“œì…ë‹ˆë‹¤.

> "ë‹¹ì‹ ì˜ ë§í•˜ê¸°ë¥¼ ì „ë¬¸ ìŠ¤í”¼ì¹˜ ì½”ì¹˜ì˜ ê·€ë¡œ ë¶„ì„í•˜ê³ , ë” ë‚˜ì€ ë²„ì „ì„ ì§ì ‘ ë“¤ë ¤ì£¼ëŠ” AI"

---

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

### Core Framework

| ê¸°ìˆ  | ë²„ì „ | ìš©ë„ |
|------|------|------|
| **FastAPI** | 0.109.0 | ë¹„ë™ê¸° ì›¹ í”„ë ˆì„ì›Œí¬ |
| **Uvicorn** | 0.27.0 | ASGI ì„œë²„ |
| **SSE-Starlette** | 1.8.2 | Server-Sent Events (ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°) |
| **Pydantic** | 2.5.3 | ë°ì´í„° ê²€ì¦ & ìŠ¤í‚¤ë§ˆ ì •ì˜ |

### AI/ML & LLM

| ê¸°ìˆ  | ë²„ì „ | ìš©ë„ |
|------|------|------|
| **LangGraph** | 0.0.26 | AI ì›Œí¬í”Œë¡œìš° ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ |
| **LangChain** | 0.1.0 | LLM ì²´ì´ë‹ & ë„êµ¬ í†µí•© |
| **OpenAI Whisper** | 1.12.0 | STT (Speech-to-Text) |
| **Claude (Anthropic)** | 0.18.0 | AI ë¶„ì„ & ê°œì„ ì•ˆ ìƒì„± |
| **ElevenLabs** | 0.2.27 | TTS (Text-to-Speech) & Voice Clone |

### AI ì—ì´ì „íŠ¸ íŒ¨í„´

| íŒ¨í„´ | ì ìš© ìœ„ì¹˜ | ì„¤ëª… |
|------|----------|------|
| **ReAct** | `analysis.py` | ë„êµ¬ë¥¼ ì‚¬ìš©í•œ ê°ê´€ì  ë°ì´í„° ìˆ˜ì§‘ í›„ ì¶”ë¡  |
| **Reflection** | `improvement.py` | ìƒì„±ëœ ê°œì„ ì•ˆì˜ í’ˆì§ˆ ìê¸° ê²€í†  |
| **RAG** | `context.py` | ê³¼ê±° ì„¸ì…˜ ê¸°ë°˜ Progressive Context |

### Database & Storage

| ê¸°ìˆ  | ìš©ë„ |
|------|------|
| **Supabase** | PostgreSQL + Storage + Auth í†µí•© |
| **PostgreSQL** | ì„¸ì…˜, í”„ë¡œì íŠ¸, ì‚¬ìš©ì ë°ì´í„° ì €ì¥ |
| **Supabase Storage** | ì˜¤ë””ì˜¤ íŒŒì¼ ì €ì¥ |

### ë¶„ì„ ë„êµ¬ (Tools)

| ë„êµ¬ | íŒŒì¼ | ê¸°ëŠ¥ |
|------|------|------|
| `analyze_pace` | `pace_analysis.py` | WPM ì¸¡ì • (ëª©í‘œ: 120-170) |
| `analyze_fillers` | `filler_analysis.py` | í•„ëŸ¬ì›Œë“œ ê°ì§€ (ì–´..., ìŒ...) |
| `analyze_star_structure` | `structure_analysis.py` | STAR êµ¬ì¡° ë¶„ì„ |

### Testing & Quality

| ê¸°ìˆ  | ë²„ì „ | ìš©ë„ |
|------|------|------|
| **Pytest** | 7.4.4 | í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ |
| **pytest-asyncio** | 0.23.3 | ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸ ì§€ì› |
| **pytest-cov** | 4.1.0 | í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ |

### Infrastructure

| ê¸°ìˆ  | ìš©ë„ |
|------|------|
| **Docker** | ì»¨í…Œì´ë„ˆí™” |
| **Railway** | ë°±ì—”ë“œ ë°°í¬ |
| **Vercel** | í”„ë¡ íŠ¸ì—”ë“œ ë°°í¬ (í˜‘ì—…) |

---

## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… | ì‚¬ìš© ê¸°ìˆ  |
|------|------|----------|
| **STT** | ìŒì„± â†’ í…ìŠ¤íŠ¸ ë³€í™˜ | OpenAI Whisper |
| **AI ë¶„ì„** | êµ¬ì¡°, í•„ëŸ¬ì›Œë“œ, ì†ë„, ìì‹ ê° í‰ê°€ | Claude + ReAct |
| **ê°œì„ ì•ˆ ìƒì„±** | ì›ë³¸ ê°œì„± ìœ ì§€í•˜ë©° ì „ë‹¬ë ¥ ê°œì„  | Claude + Reflection |
| **TTS** | ê°œì„ ì•ˆ â†’ ìŒì„± ë³€í™˜ | ElevenLabs |
| **Voice Clone** | ì‚¬ìš©ì ëª©ì†Œë¦¬ë¡œ TTS | ElevenLabs Clone |
| **Progressive Context** | ê³¼ê±° ì„¸ì…˜ ê¸°ë°˜ ì—°ì† ì½”ì¹­ | RAG íŒ¨í„´ |

---

## ğŸ“Š ì›Œí¬í”Œë¡œìš° (LangGraph)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Speech Coach Workflow                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  [START]                                                        â”‚
â”‚     â”‚                                                           â”‚
â”‚     â–¼                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚  Load Context    â”‚  â† RAG: ê³¼ê±° ì„¸ì…˜ & ë¬¸ì„œ                   â”‚
â”‚  â”‚   (context.py)   â”‚                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚           â”‚                                                     â”‚
â”‚           â–¼                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚      STT         â”‚  â† OpenAI Whisper API                     â”‚
â”‚  â”‚    (stt.py)      â”‚                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚           â”‚                                                     â”‚
â”‚           â–¼                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚   Moderation     â”‚  â† ìš•ì„¤/PII ì²´í¬                          â”‚
â”‚  â”‚ (moderation.py)  â”‚                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚           â”‚                                                     â”‚
â”‚           â–¼                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚    Analysis      â”‚ â”€â”€â–¶ â”‚ Tools (ReAct íŒ¨í„´)          â”‚       â”‚
â”‚  â”‚  (analysis.py)   â”‚ â—€â”€â”€ â”‚ â€¢ pace_analysis             â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â€¢ filler_analysis           â”‚       â”‚
â”‚           â”‚               â”‚ â€¢ structure_analysis        â”‚       â”‚
â”‚           â–¼               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚   Improvement    â”‚  â† Claude: ê°œì„ ì•ˆ 1ì°¨ ìƒì„±                 â”‚
â”‚  â”‚ (improvement.py) â”‚                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚           â”‚                                                     â”‚
â”‚           â–¼                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚   Reflection     â”‚  â† ìê¸° ê²€í†  & í’ˆì§ˆ ë³´ì¥                   â”‚
â”‚  â”‚ (improvement.py) â”‚                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚           â”‚                                                     â”‚
â”‚           â–¼                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚      TTS         â”‚  â† ElevenLabs API                         â”‚
â”‚  â”‚    (tts.py)      â”‚                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚           â”‚                                                     â”‚
â”‚           â–¼                                                     â”‚
â”‚       [END]                                                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
backend/
â”œâ”€â”€ api/                        # FastAPI ë ˆì´ì–´
â”‚   â”œâ”€â”€ main.py                 # ì•± ì§„ì…ì , ë¯¸ë“¤ì›¨ì–´
â”‚   â”œâ”€â”€ config.py               # í™˜ê²½ë³€ìˆ˜ (Pydantic Settings)
â”‚   â”œâ”€â”€ dependencies.py         # JWT ê²€ì¦, Supabase í´ë¼ì´ì–¸íŠ¸
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ analyze.py          # POST /analyze (SSE ìŠ¤íŠ¸ë¦¬ë°)
â”‚   â”‚   â”œâ”€â”€ refine.py           # POST /refine (3ë‹¨ê³„ ì¬ìš”ì²­)
â”‚   â”‚   â””â”€â”€ health.py           # Health check
â”‚   â””â”€â”€ schemas/
â”‚       â”œâ”€â”€ requests.py         # ìš”ì²­ ìŠ¤í‚¤ë§ˆ
â”‚       â””â”€â”€ responses.py        # ì‘ë‹µ ìŠ¤í‚¤ë§ˆ
â”‚
â”œâ”€â”€ langgraph/                  # AI ì›Œí¬í”Œë¡œìš° (í•µì‹¬)
â”‚   â”œâ”€â”€ state.py                # SpeechCoachState ì •ì˜
â”‚   â”œâ”€â”€ nodes/                  # ê·¸ë˜í”„ ë…¸ë“œ
â”‚   â”‚   â”œâ”€â”€ stt.py              # Whisper STT
â”‚   â”‚   â”œâ”€â”€ analysis.py         # Claude ë¶„ì„ (ReAct)
â”‚   â”‚   â”œâ”€â”€ improvement.py      # ê°œì„ ì•ˆ ìƒì„± (Reflection)
â”‚   â”‚   â”œâ”€â”€ tts.py              # ElevenLabs TTS
â”‚   â”‚   â”œâ”€â”€ context.py          # Progressive Context (RAG)
â”‚   â”‚   â””â”€â”€ moderation.py       # ì½˜í…ì¸  ëª¨ë”ë ˆì´ì…˜
â”‚   â”œâ”€â”€ tools/                  # ReActìš© ë¶„ì„ ë„êµ¬
â”‚   â”‚   â”œâ”€â”€ pace_analysis.py    # WPM ì¸¡ì •
â”‚   â”‚   â”œâ”€â”€ filler_analysis.py  # í•„ëŸ¬ì›Œë“œ ê°ì§€
â”‚   â”‚   â””â”€â”€ structure_analysis.py # STAR êµ¬ì¡° ë¶„ì„
â”‚   â”œâ”€â”€ workflows/              # ê·¸ë˜í”„ ì •ì˜
â”‚   â”‚   â”œâ”€â”€ speech_coach.py     # ë©”ì¸ ì›Œí¬í”Œë¡œìš°
â”‚   â”‚   â””â”€â”€ refinement.py       # ì¬ìš”ì²­ ì›Œí¬í”Œë¡œìš°
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ prompts.py          # Claude í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
â”‚       â””â”€â”€ audio.py            # ì˜¤ë””ì˜¤ ìœ í‹¸ë¦¬í‹°
â”‚
â””â”€â”€ tests/                      # í…ŒìŠ¤íŠ¸ ì½”ë“œ
    â”œâ”€â”€ conftest.py             # Pytest fixtures
    â”œâ”€â”€ nodes/test_tools.py     # ë„êµ¬ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
    â””â”€â”€ workflows/test_speech_coach.py
```

---

## ğŸ”§ í™˜ê²½ë³€ìˆ˜

| ë³€ìˆ˜ | ì„¤ëª… | í•„ìˆ˜ |
|------|------|:----:|
| `SUPABASE_URL` | Supabase í”„ë¡œì íŠ¸ URL | âœ… |
| `SUPABASE_SERVICE_KEY` | Supabase ì„œë¹„ìŠ¤ í‚¤ | âœ… |
| `OPENAI_API_KEY` | OpenAI API í‚¤ (Whisper) | âœ… |
| `ANTHROPIC_API_KEY` | Anthropic API í‚¤ (Claude) | âœ… |
| `ELEVENLABS_API_KEY` | ElevenLabs API í‚¤ (TTS) | âœ… |
| `ALLOWED_ORIGINS` | CORS í—ˆìš© ë„ë©”ì¸ | âŒ |

---

## ğŸ“š API ì—”ë“œí¬ì¸íŠ¸

| Method | Endpoint | ì„¤ëª… | ì¸ì¦ |
|--------|----------|------|:----:|
| `POST` | `/api/v1/analyze` | ìŠ¤í”¼ì¹˜ ë¶„ì„ (SSE) | ì„ íƒ |
| `POST` | `/api/v1/refine` | ê°œì„ ì•ˆ ì¬ìƒì„± | ì„ íƒ |
| `GET` | `/health` | ì„œë²„ ìƒíƒœ + ì™¸ë¶€ ì„œë¹„ìŠ¤ í™•ì¸ | âŒ |
| `GET` | `/ping` | ì„œë²„ ìƒì¡´ í™•ì¸ | âŒ |

---

## ğŸš€ ì‹œì‘í•˜ê¸°

### ë¡œì»¬ ê°œë°œ

```bash
# 1. ê°€ìƒí™˜ê²½ ìƒì„±
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 2. ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt

# 3. í™˜ê²½ë³€ìˆ˜ ì„¤ì •
cp .env.example .env
# .env íŒŒì¼ í¸ì§‘í•˜ì—¬ API í‚¤ ì…ë ¥

# 4. ì„œë²„ ì‹¤í–‰
uvicorn api.main:app --reload --port 8000
```

### Docker

```bash
# ë¹Œë“œ
docker build -t sosoo-backend .

# ì‹¤í–‰
docker run -p 8000:8000 --env-file .env sosoo-backend
```

### í…ŒìŠ¤íŠ¸

```bash
# ì „ì²´ í…ŒìŠ¤íŠ¸
pytest

# ì»¤ë²„ë¦¬ì§€ í¬í•¨
pytest --cov=langgraph --cov=api

# íŠ¹ì • í…ŒìŠ¤íŠ¸
pytest tests/nodes/test_tools.py -v
```

---

## ğŸ“– API ë¬¸ì„œ

ì„œë²„ ì‹¤í–‰ í›„:
- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

---

## ğŸ“„ ë¼ì´ì„ ìŠ¤

MIT License